#this network policy is implemented using calico cni plugin
  #check the nodes is any of the nodes is showing not ready to trouble shoot
  a. first check kubelet is running or not
    135  systemctl status kubelet

  b. check containerd is running of not 
  136  systemctl status containerd

  c. check the cni pod is running or not 
   132  kubectl get nodes
  133  kubectl get pod -A
  ###as network policy will be applied in namespace 
  #we will create a namespace and create two pod inside the namespace and check they are communication with each other or not
   139  kubectl create ns ecom
  140  kubectl -n ecom run frontend --image=nginx
  141  kubectl -n ecom run backend --image=nginx
  142  kubectl -n ecom get pod
###lets expose or create service for your pod 
   146  kubectl -n ecom expose pod frontend --port 80
  147  kubectl -n ecom expose pod backend --port 80

  149  kubectl -n ecom get pod,svc
  #lets check that frontend can communicate with backend or not 
  152  kubectl -n ecom exec frontend -- curl backend
  153  kubectl -n ecom exec backend -- curl frontend
###both the way communication is happening
#to disable the communication betwen this pod isnide the namespace we need to create an deny rule
 155  vi default-deny.yml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: default-deny
  namespace: ecom 
spec:
  podSelector: {} #from here we start creating exception
    
  policyTypes:
  - Ingress
  - Egress
  
  156  kubectl apply -f default-deny.yml
  157  kubectl -n ecom get networkpolicy
#if you describe the policy you will see everything is disabled ingress and egress routing
  158  kubectl -n ecom describe networkpolicy default-deny
#this time curl request will not work
  159  kubectl -n ecom exec backend -- curl frontend
  160  kubectl -n ecom exec frontend -- curl backend

