#lets expose this deployment 
130  kubectl get deploy
 #this will give you the help
  132  kubectl expose my-first-deployment  --help
  #we are exposing using NodePort
  133  kubectl expose deployment my-first-deployment  --type=NodePort --name=my-first-service
  #this will show the portnumber in 30k series 
  ##login to any of the nodemachine get the private ip 
  134  kubectl get svc
  ####open the browser paste the private ip : port number
#lets update the image
 141  kubectl set image deployment my-first-deployment nginx=nulldevil/phpsysinfo
#this will show that there is an update going on
  142  kubectl get deploy
#now the replicaset will show there are two rs
  143  kubectl get rs
#if you look into the describe deploy you will see event where you will see two rs
  144  kubectl describe deploy my-first-deployment
  #this will show the rollout status
  146  kubectl rollout status deploy my-first-deployment
#this will show the pod
  147  kubectl get pod
  148  kubectl describe deploy my-first-deployment
#now check the ip address of all the pod 
  149  kubectl get pod -o wide
#finally refresh the page you will see php sysinfo which is connected to your one pod refresh the page after 30 second
#it means svc in roudn robin fashion moving the traffic from one pod to another
##lets check the rollout status and there revison
#rollout history will show that there is two revision 
151  kubectl rollout history deployment my-first-deployment
#if you want to see which image is in revision you can see it
  152  kubectl rollout history deployment my-first-deployment --revision=1
  153  kubectl rollout history deployment my-first-deployment --revision=2
##if you want to roll back to the previous release
#rs will show that you have two different revision
  155  kubectl get rs
#if you want to move to another revision
  158  kubectl rollout undo deployment my-first-deployment --to-revision=1
###now yoy will see the previos rs is zero
  159  kubectl get rs
#describe deploy will show that the name image
  160  kubectl describe deploy my-first-deployment
##refresh your page delete everything after the port number now you will see the nginx test page
#lets scale out the deployment we will do manual scaling
 163  kubectl get deploy
  #scale command will allow you to do manual scaling
  165  kubectl scale deploy my-first-deployment --replicas=5
#now get deploy show that you have 5 pod
  166  kubectl get deploy
#get pod show 5 pod
  167  kubectl get pod
###lets do autoscaling it can be done using cpu network ram
 169  kubectl autoscale
  170  kubectl autoscale --help
  171  kubectl autoscale deploy my-first-deployment --min=5 --max=10 --cpu-percent=80
#get hpa horizontal pod autoscaler
  172  kubectl get hpa
  173  history
###lets trouble shoot on the networking part dns resolution inside k8s using nslookup 
 175  kubectl get svc
#we will get an dns pod
  176  kubectl apply -f https://k8s.io/examples/admin/dns/dnsutils.yaml
  177  kubectl get pod
#inside the dns pod we will look into kubernetes servcie
  178  kubectl exec -i -t dnsutils -- nslookup kubernetes.default
  179  kubectl get svc
#we can check our service using ns lookup
  181  kubectl exec -i -t dnsutils -- nslookup my-first-service.default
#you can use ab bench utility to increase the load 
  182  kubectl run apache-bench -i --tty --rm --image=httpd -- ab -n 500000 -c 1000 http:// my-first-service.default.svc.cluster.local
  183  kubectl run apache-bench -i --tty --rm --image=httpd -- ab -n 500000 -c 1000 http:// my-first-service.default

  
